<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{base :: head}"></head>
<body>
<header th:replace="~{base :: header}"></header>

<main class="container mt-4">
    <h2>‚úâÔ∏è G·ª≠i th∆∞ m·ªùi</h2>

    <form th:action="@{/notification/send}" method="post">
        <!-- Ch·ªçn th√¥ng b√°o -->
        <div class="mb-3">
            <label for="notificationId" class="form-label">Ch·ªçn th√¥ng b√°o:</label>
            <select class="form-select" name="notificationId" id="notificationId" required>
                <option th:each="n : ${notifications}" th:value="${n.id}" th:text="${n.title}"></option>
            </select>
        </div>

        <!-- Lo·∫°i ng∆∞·ªùi nh·∫≠n -->
        <div class="mb-3">
            <label class="form-label">Ch·ªçn ng∆∞·ªùi nh·∫≠n:</label>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="recipientType" id="all" value="all" checked>
                <label class="form-check-label" for="all">T·∫•t c·∫£ c·ª±u sinh vi√™n</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="recipientType" id="group" value="group">
                <label class="form-check-label" for="group">Theo nh√≥m</label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="radio" name="recipientType" id="individual" value="individual">
                <label class="form-check-label" for="individual">Theo c√° nh√¢n</label>
            </div>
        </div>

        <!-- Checkbox nh√≥m -->
        <div class="mb-3" id="groupSelection" style="display: none;">
            <label class="form-label">Ch·ªçn nh√≥m:</label>
            <div th:each="g : ${userGroups}" class="form-check">
                <input class="form-check-input" type="checkbox" name="groupIds" th:value="${g.id}" th:id="'group_' + ${g.id}">
                <label class="form-check-label" th:for="'group_' + ${g.id}" th:text="${g.name}"></label>
            </div>
        </div>

        <!-- Checkbox ng∆∞·ªùi d√πng -->
        <div class="mb-3" id="userSelection" style="display: none;">
            <label class="form-label">Ch·ªçn ng∆∞·ªùi d√πng:</label>
            <div th:each="u : ${users}" class="form-check">
                <input class="form-check-input" type="checkbox" name="userIds" th:value="${u.id}" th:id="'user_' + ${u.id}">
                <label class="form-check-label" th:for="'user_' + ${u.id}" th:text="${u.fullName} + ' (' + ${u.email} + ')'"></label>
            </div>
        </div>

        <button type="submit" class="btn btn-primary">üì§ G·ª≠i th∆∞ m·ªùi</button>
    </form>
</main>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const radios = document.getElementsByName("recipientType");
        const groupSection = document.getElementById("groupSelection");
        const userSection = document.getElementById("userSelection");

        function toggleSections() {
            const selected = Array.from(radios).find(r => r.checked)?.value;
            groupSection.style.display = selected === "group" ? "block" : "none";
            userSection.style.display = selected === "individual" ? "block" : "none";
        }

        radios.forEach(r => r.addEventListener("change", toggleSections));
        toggleSections(); // run at start
    });
</script>

<footer th:replace="~{base :: footer}"></footer>
</body>
</html>
